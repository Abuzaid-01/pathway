# System Architecture Diagram

## High-Level Pipeline Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     INPUT LAYER                                  â”‚
â”‚  Novel (100k+ words) + Character Backstory                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 PATHWAY DATA INGESTION                           â”‚
â”‚  â€¢ CSV streaming (train.csv, test.csv)                          â”‚
â”‚  â€¢ Book text loading with caching                               â”‚
â”‚  â€¢ Structured data objects                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MULTI-STRATEGY CHUNKING                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Structural â”‚  â”‚ Character-   â”‚  â”‚  Overlapping    â”‚        â”‚
â”‚  â”‚ (chapters) â”‚  â”‚ Centric      â”‚  â”‚  Windows        â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€                 â”‚
â”‚                                            â”‚                    â”‚
â”‚                    Hybrid Chunks (500-1500 tokens)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           PATHWAY VECTOR STORE + INDEXING                        â”‚
â”‚  â€¢ Sentence-BERT embeddings (768-dim)                           â”‚
â”‚  â€¢ FAISS index (cosine similarity)                              â”‚
â”‚  â€¢ Character-specific indexes                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MULTI-STAGE RETRIEVAL                               â”‚
â”‚                                                                  â”‚
â”‚  Stage 1: Broad Context (top-20)                                â”‚
â”‚    â†“                                                             â”‚
â”‚  Stage 2: Targeted Evidence (top-15)                            â”‚
â”‚    â†“                                                             â”‚
â”‚  Stage 3: Contradiction Mining (top-10) â­ NOVEL                â”‚
â”‚    â†“                                                             â”‚
â”‚  Stage 4: Causal Neighbors (top-10)                             â”‚
â”‚                                                                  â”‚
â”‚  â†’ Comprehensive Evidence Bundle                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ADVERSARIAL REASONING FRAMEWORK â­ NOVEL                â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  ğŸ”´ PROSECUTOR  â”‚  â”‚ ğŸŸ¢ DEFENSE   â”‚  â”‚  âš–ï¸  JUDGE   â”‚      â”‚
â”‚  â”‚  Agent          â”‚  â”‚ Agent        â”‚  â”‚  Agent       â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ â€¢ Find          â”‚  â”‚ â€¢ Find       â”‚  â”‚ â€¢ Weigh both â”‚      â”‚
â”‚  â”‚   contradictionsâ”‚  â”‚   support    â”‚  â”‚   sides      â”‚      â”‚
â”‚  â”‚ â€¢ Use NLI       â”‚  â”‚ â€¢ Check      â”‚  â”‚ â€¢ Balance    â”‚      â”‚
â”‚  â”‚   model         â”‚  â”‚   entailment â”‚  â”‚   evidence   â”‚      â”‚
â”‚  â”‚ â€¢ Temporal      â”‚  â”‚ â€¢ Plausible  â”‚  â”‚ â€¢ Make       â”‚      â”‚
â”‚  â”‚   violations    â”‚  â”‚   links      â”‚  â”‚   judgment   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚           â”‚                  â”‚                  â”‚               â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                              â”‚                                  â”‚
â”‚                   Adversarial Judgment                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ENSEMBLE SCORING SYSTEM                             â”‚
â”‚                                                                  â”‚
â”‚  Score 1: Direct Contradiction        (Weight: 30%)             â”‚
â”‚  â”œâ”€ NLI model: BART-large-mnli                                  â”‚
â”‚  â””â”€ Contradiction score (0-1)                                   â”‚
â”‚                                                                  â”‚
â”‚  Score 2: Causal Plausibility         (Weight: 25%)             â”‚
â”‚  â”œâ”€ Causal chain verification                                   â”‚
â”‚  â””â”€ Event sequence checking                                     â”‚
â”‚                                                                  â”‚
â”‚  Score 3: Character Consistency       (Weight: 20%)             â”‚
â”‚  â”œâ”€ Personality alignment                                       â”‚
â”‚  â””â”€ Behavioral patterns                                         â”‚
â”‚                                                                  â”‚
â”‚  Score 4: Temporal Coherence          (Weight: 15%)             â”‚
â”‚  â”œâ”€ Age/date extraction                                         â”‚
â”‚  â””â”€ Timeline validation                                         â”‚
â”‚                                                                  â”‚
â”‚  Score 5: Narrative Fit               (Weight: 10%)             â”‚
â”‚  â”œâ”€ Genre conventions                                           â”‚
â”‚  â””â”€ Story arc compatibility                                     â”‚
â”‚                                                                  â”‚
â”‚  Combined Score = Weighted Average + Adversarial Score          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                DECISION AGGREGATION                              â”‚
â”‚                                                                  â”‚
â”‚  If Combined Score >= 0.5:                                      â”‚
â”‚    â†’ Prediction: 1 (Consistent)                                 â”‚
â”‚  Else:                                                           â”‚
â”‚    â†’ Prediction: 0 (Contradict)                                 â”‚
â”‚                                                                  â”‚
â”‚  + Confidence Score                                             â”‚
â”‚  + Explanation                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     OUTPUT LAYER                                 â”‚
â”‚                                                                  â”‚
â”‚  results.csv:                                                   â”‚
â”‚    id, label (consistent/contradict)                            â”‚
â”‚                                                                  â”‚
â”‚  Detailed results:                                              â”‚
â”‚    + Confidence scores                                          â”‚
â”‚    + Individual metric scores                                   â”‚
â”‚    + Explanation                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Interaction Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  run.py      â”‚  â† Main Orchestrator
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   â”‚  ingest.py   â”‚  â† Data Loading (Pathway)
       â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   â”‚  chunking.py â”‚  â† Text Segmentation
       â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   â”‚ retrieval.py â”‚  â† Vector Search (Pathway + FAISS)
       â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   â”‚ reasoning.py â”‚  â† Adversarial Framework
       â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â””â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ decision.py  â”‚  â† Final Classification
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

All modules read: config.py
All modules log to: pipeline.log
```

---

## Data Flow Through Retrieval Stages

```
Backstory: "John was a peaceful scholar who never traveled"
                          â”‚
                          â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Stage 1: Broad Context            â”‚
        â”‚   Query: "John", "John background"  â”‚
        â”‚   â†’ 20 chunks about John            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Stage 2: Targeted Evidence        â”‚
        â”‚   Claims: ["peaceful", "scholar",   â”‚
        â”‚            "never traveled"]        â”‚
        â”‚   â†’ 15 chunks with evidence         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Stage 3: Contradiction Mining â­  â”‚
        â”‚   Queries: "John never", "John not",â”‚
        â”‚            "John traveled"           â”‚
        â”‚   â†’ 10 chunks with conflicts        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Stage 4: Causal Neighbors         â”‚
        â”‚   From top chunks, find related     â”‚
        â”‚   â†’ 10 causally connected chunks    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
              55 total chunks
     (deduplicated, ranked by relevance)
```

---

## Adversarial Reasoning Flow

```
                Evidence Bundle
                      â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼            â–¼            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ğŸ”´    â”‚  â”‚   ğŸŸ¢    â”‚  â”‚  âš–ï¸    â”‚
    â”‚Prosecutâ”‚  â”‚ Defense â”‚  â”‚ Judge  â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
         â”‚           â”‚            â”‚
         â”‚ Finds:    â”‚ Finds:     â”‚ Decides:
         â”‚ â€¢ 3 contradictions    â”‚
         â”‚ â€¢ 2 temporal issues   â”‚ Weighs
         â”‚           â”‚ â€¢ 5 supports      â”‚ both
         â”‚ Strength: 0.7        â”‚ sides
         â”‚           â”‚ â€¢ 3 links â”‚
         â”‚           â”‚ Strength: 0.4     â”‚
         â”‚           â”‚            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                  â–¼
                         Consistency Score
                         = (0.4 - 0.7 + 1) / 2
                         = 0.35
                         â†’ Contradict (< 0.5)
```

---

## Ensemble Scoring Calculation

```
Individual Scores:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Metric              â”‚ Score â”‚ Weight â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Contradiction       â”‚  0.3  â”‚  30%   â”‚
â”‚ Causal              â”‚  0.6  â”‚  25%   â”‚
â”‚ Character           â”‚  0.7  â”‚  20%   â”‚
â”‚ Temporal            â”‚  0.5  â”‚  15%   â”‚
â”‚ Narrative           â”‚  0.8  â”‚  10%   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ensemble Score:
= 0.3Ã—0.30 + 0.6Ã—0.25 + 0.7Ã—0.20 + 0.5Ã—0.15 + 0.8Ã—0.10
= 0.09 + 0.15 + 0.14 + 0.075 + 0.08
= 0.535

Adversarial Score: 0.35

Combined Score:
= (0.535 + 0.35) / 2
= 0.4425

Decision: Contradict (< 0.5)
```

---

## Chunking Strategy Visualization

```
Original Novel (100,000 words)
â”‚
â”œâ”€ Structural Chunking
â”‚  â””â”€ By chapters/scenes
â”‚     â†’ 50 chunks (1000-2000 words each)
â”‚
â”œâ”€ Character-Centric Chunking
â”‚  â””â”€ Passages mentioning character
â”‚     â†’ 30 chunks (context windows around mentions)
â”‚
â””â”€ Overlapping Windows
   â””â”€ Sliding window with overlap
      â†’ 100 chunks (sampled to 33)
      
Total: 113 unique chunks
After deduplication: ~80 chunks per book-character pair
```

---

## Pathway Integration Points

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Pathway Framework            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  1. Data Ingestion                   â”‚
â”‚     pw.io.csv.read()                 â”‚
â”‚     â†“                                â”‚
â”‚     Streaming table                  â”‚
â”‚                                      â”‚
â”‚  2. Vector Store                     â”‚
â”‚     PathwayVectorStore               â”‚
â”‚     â†“                                â”‚
â”‚     FAISS index integration          â”‚
â”‚                                      â”‚
â”‚  3. Pipeline Orchestration           â”‚
â”‚     Data transformation operators    â”‚
â”‚     â†“                                â”‚
â”‚     Batch processing                 â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## File Dependencies Graph

```
run.py
  â”œâ”€â†’ config.py
  â”œâ”€â†’ ingest.py
  â”‚     â””â”€â†’ pathway
  â”œâ”€â†’ chunking.py
  â”œâ”€â†’ retrieval.py
  â”‚     â”œâ”€â†’ pathway
  â”‚     â”œâ”€â†’ sentence_transformers
  â”‚     â””â”€â†’ faiss
  â”œâ”€â†’ reasoning.py
  â”‚     â”œâ”€â†’ transformers (NLI)
  â”‚     â””â”€â†’ openai (optional)
  â””â”€â†’ decision.py

All modules depend on:
  â€¢ config.py
  â€¢ loguru (logging)
  â€¢ numpy
  â€¢ typing
```

---

## Timeline of Execution

```
0s   â”‚ Start pipeline
     â”‚ â”œâ”€ Load configuration
     â”‚ â””â”€ Initialize components
     â”‚
2s   â”‚ Ingest data (Pathway)
     â”‚ â”œâ”€ Load CSV files
     â”‚ â””â”€ Load book texts
     â”‚
10s  â”‚ First example: "Count of Monte Cristo - Faria"
     â”‚ â”œâ”€ Chunk novel (5s)
     â”‚ â”œâ”€ Index with FAISS (3s)
     â”‚ â””â”€ Cache created
     â”‚
25s  â”‚ Retrieve evidence
     â”‚ â”œâ”€ Stage 1: Broad (2s)
     â”‚ â”œâ”€ Stage 2: Targeted (3s)
     â”‚ â”œâ”€ Stage 3: Contradictions (3s)
     â”‚ â””â”€ Stage 4: Causal (2s)
     â”‚
50s  â”‚ Adversarial reasoning
     â”‚ â”œâ”€ Prosecutor analysis (8s)
     â”‚ â”œâ”€ Defense analysis (7s)
     â”‚ â””â”€ Judge decision (5s)
     â”‚
65s  â”‚ Ensemble scoring
     â”‚ â””â”€ 5 metrics computed
     â”‚
70s  â”‚ Final decision
     â”‚ â””â”€ Output: Contradict (0)
     â”‚
...  â”‚ Repeat for remaining examples
     â”‚ (Faster with cache: ~20-30s each)
     â”‚
30m  â”‚ Complete! (61 test examples)
     â””â”€ Results saved to results.csv
```

---

## Memory Usage Profile

```
Component              Memory
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Embedding Model        ~500 MB
NLI Model              ~1 GB
FAISS Index (per book) ~100 MB
Book Chunks Cache      ~200 MB
Working Memory         ~500 MB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total Peak:            ~2.5 GB

With LLM API calls:    +1 GB
With large batch:      +2 GB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Recommended:           4-8 GB RAM
```

---

This visualization helps understand:
- System architecture
- Component interactions
- Data flow
- Decision logic
- Resource usage

Refer back to this when debugging or explaining the system!
